!function(){var a=function(a,b,c){var d,e,f=null,g=null,h=a.observable(b.get(c));return d=function(a){h(null===f?a:f(a))},b.subscribe(c,d),e=h.subscribe(function(a){null===g?b.set(c,a):b.set(c,g(a))}),h.destroyBindings=function(){b.unsubscribe(c,d),e.dispose(),delete h.destroyBindings,delete h.formatDownStream,delete h.formatUpStream},h.setDownstreamFormatter=function(a){f=a},h.setUpstreamFormatter=function(a){g=a},h},b=function(a){this.ko=a};b.prototype.getObservable=function(b,c){return a(this.ko,b,c)},b.prototype.getViewList=function(a,b){return new c(this.ko,a,b)},"object"==typeof exports?module.exports=b:"function"==typeof define&&define.amd?define(function(){return b}):window.KoTools=b;var c=function(a,b,c){this._list=c,this._list.subscribe(this.updateEntries.bind(this)),this._standardTemplate=null,this._emptyTemplate=null,this._isEmpty=!0,this._viewModel=b,this._entries={},this.entries=a.observableArray([])};c.prototype.setTemplates=function(a,b){this._standardTemplate=a,this._emptyTemplate=b},c.prototype.setEmptyViewModel=function(a){this._emptyViewModel=a},c.prototype.getTemplate=function(){return this._isEmpty===!0?this._emptyTemplate:this._standardTemplate},c.prototype.getList=function(){return this._list},c.prototype.empty=function(){this._entries={},this.entries([])},c.prototype.callOnEntries=function(a,b){for(var c=this.entries(),d=0;d<c.length;d++)if(c[d]!==this){if("function"!=typeof c[d][a])throw"Viewlist entry doesn't have method "+a;c[d][a].apply(c[d],b||[])}},c.prototype.destroy=function(){this._list&&(this._list.unsubscribe(this.updateEntries,this),this._list.discard(),this._list=null),this.entries([]),delete this._entries},c.prototype.getSubjects=function(){return Object.keys(this._entries)},c.prototype.updateEntries=function(a){var b,c=[],d=a.length;for(b=0;b!==d;b++)this._entries[a[b]]||(this._entries[a[b]]=new this._viewModel(a[b],this)),c.push(this._entries[a[b]]);0===c.length&&this._emptyTemplate?(c.push(this._emptyViewModel||this),this._isEmpty=!0):this._isEmpty=!1,this.entries(c)}}();